<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Carregando...</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="app.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }
        .editor-container {
            display: none; /* Inicialmente oculto até carregar */
        }
        .loading {
            text-align: center;
            padding: 2rem;
        }
    </style>
</head>
<body>
    <div class="loading">
        <p>Carregando sua página...</p>
    </div>

    <div class="editor-container">
        <div class="header">
            <h1>DontPage</h1>
            <button id="new-page">Nova Página</button>
        </div>

        <div class="page-info">
            <div id="page-id-display"></div>
        </div>

        <textarea id="editor" placeholder="Digite seu conteúdo aqui..."></textarea>

        <div class="status-bar">
            <div id="last-saved">Não salvo ainda</div>
            <div id="char-count">0 caracteres</div>
        </div>

        <div class="share-section">
            <h3>Compartilhar esta página</h3>
            <div class="share-controls">
                <input type="text" id="page-url" readonly>
                <button id="copy-url">Copiar URL</button>
                <button id="share-whatsapp">WhatsApp</button>
            </div>
        </div>
    </div>

    <script>
        // Extrai o nome da página da URL
        const path = window.location.pathname.substring(1);
        const pageName = path.toLowerCase().replace(/[^a-z0-9-]/g, '');
        
        if (pageName) {
            // Inicializa o editor para esta página
            initializeEditor(pageName);
        } else {
            window.location.replace('/');
        }

        function initializeEditor(pageId) {
            // Mostra o editor e esconde o loading
            document.querySelector('.editor-container').style.display = 'block';
            document.querySelector('.loading').style.display = 'none';
            
            // Inicializa a aplicação
            initializeApp();
            loadPage(pageId);
        }
    </script>
</body>
</html>